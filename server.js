// server.js
const express = require('express');
const cors = require('cors');
require('dotenv').config(); // Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð¸Ð· .env

const app = express();
const PORT = process.env.PORT || 3000; // ÐŸÐ¾Ð·Ð²Ð¾Ð»Ð¸Ð¼ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ðµ Ð·Ð°Ð´Ð°Ñ‚ÑŒ Ð¿Ð¾Ñ€Ñ‚, Ð¸Ð½Ð°Ñ‡Ðµ 3000

// --- Middleware ---
// ÐŸÐ¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ ÑÐµÑ€Ð²ÐµÑ€Ñƒ Ð¿Ð¾Ð½Ð¸Ð¼Ð°Ñ‚ÑŒ JSON Ð² Ñ‚ÐµÐ»Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°
app.use(express.json());
// Ð Ð°Ð·Ñ€ÐµÑˆÐ°ÐµÐ¼ CORS (Ð²Ð°Ð¶Ð½Ð¾ Ð´Ð»Ñ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² Ñ Ñ„Ñ€Ð¾Ð½Ñ‚ÐµÐ½Ð´Ð° Ð½Ð° Ð´Ñ€ÑƒÐ³Ð¾Ð¹ Ð´Ð¾Ð¼ÐµÐ½)
app.use(cors({
  origin: "*" // Ð’ production Ð»ÑƒÑ‡ÑˆÐµ ÑƒÐºÐ°Ð·Ð°Ñ‚ÑŒ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ð¹ origin, Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð²Ð°Ñˆ GitHub Pages URL
}));

// --- ÐœÐ°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹ ---
// ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚ Ð´Ð»Ñ Ñ‡Ð°Ñ‚Ð°
const chatRoutes = require('./routes/chat');
app.use('/api', chatRoutes); // Ð’ÑÐµ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹ Ð¸Ð· chat.js Ð±ÑƒÐ´ÑƒÑ‚ Ð½Ð°Ñ‡Ð¸Ð½Ð°Ñ‚ÑŒÑÑ Ñ /api

// --- Ð—Ð°Ð¿ÑƒÑÐº ÑÐµÑ€Ð²ÐµÑ€Ð° ---
app.listen(PORT, '0.0.0.0', () => {
  console.log(`ðŸš€ Ð¡ÐµÑ€Ð²ÐµÑ€ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð½Ð° Ð¿Ð¾Ñ€Ñ‚Ñƒ ${PORT}`);
});
